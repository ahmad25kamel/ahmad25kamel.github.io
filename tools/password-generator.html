<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secure Password Generator - Private Online Tools</title>
    <meta name="description" content="Generate strong, secure passwords with customizable options. Check password strength, create passphrases, and manage multiple passwords. 100% client-side.">
    <meta name="keywords" content="password generator, secure password, strong password, password strength, passphrase generator, random password, security tools, privacy">
    <link rel="icon" type="image/png" href="../assets/img/favicon.png">
    
    <!-- Local CSS -->
    <link rel="stylesheet" href="../assets/css/minimal-tailwind.css">
    
    <!-- i18n Support -->
    <script src="../assets/js/i18n.js"></script>
    
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .back-to-tools-btn {
            transition: all 0.3s ease;
        }
        .back-to-tools-btn:hover {
            background-color: rgba(255, 255, 255, 0.3) !important;
        }
        .tab-button {
            transition: all 0.3s ease;
        }
        .tab-button.active {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            color: white;
        }
        
        .password-display {
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 18px;
            letter-spacing: 1px;
            word-break: break-all;
            padding: 20px;
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            min-height: 60px;
            display: flex;
            align-items: center;
        }
        
        .strength-indicator {
            height: 8px;
            border-radius: 4px;
            transition: all 0.3s ease;
        }
        
        .strength-very-weak { background: #ef4444; width: 20%; }
        .strength-weak { background: #f97316; width: 40%; }
        .strength-fair { background: #eab308; width: 60%; }
        .strength-good { background: #22c55e; width: 80%; }
        .strength-strong { background: #16a34a; width: 100%; }
        
        .floating-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 50px;
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            z-index: 1000;
        }
        
        .floating-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(99, 102, 241, 0.4);
        }
        
        /* Notification styles */
        .notification-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            max-width: 400px;
        }
        
        .notification {
            background: white;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            border-left: 4px solid;
            opacity: 0;
            transform: translateX(100%);
            transition: all 0.3s ease;
        }
        
        .notification.show {
            opacity: 1;
            transform: translateX(0);
        }
        
        .notification.success {
            border-left-color: #10b981;
        }
        
        .notification.error {
            border-left-color: #ef4444;
        }
        
        .notification.warning {
            border-left-color: #f59e0b;
        }
        
        .password-history-item {
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
        }
        
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: #6366f1;
        }
        
        input:checked + .slider:before {
            transform: translateX(26px);
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="gradient-bg text-white py-4">
        <div class="container mx-auto px-4">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-2xl md:text-3xl font-bold">Secure Password Generator</h1>
                    <p class="text-sm md:text-base opacity-90">Generate strong, secure passwords and passphrases</p>
                </div>
                <div class="navigation-wrapper">
                    <!-- Breadcrumb container for dynamic breadcrumbs -->
                    <div class="breadcrumb-container text-sm opacity-75 mb-2"></div>
                    <a href="/" class="back-to-tools-btn bg-white bg-opacity-20 hover:bg-opacity-30 px-4 py-2 rounded transition-colors">
                        ‚Üê Back to Tools
                    </a>
                </div>
            </div>
        </div>
    </header>

    <!-- Notification Container -->
    <div id="notificationContainer" class="notification-container"></div>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <!-- Tab Navigation -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
            <div class="flex flex-col md:flex-row gap-4 mb-6">
                <button id="passwordGeneratorTab" class="tab-button active flex-1 py-3 px-6 rounded-lg font-medium transition-colors">
                    üîê Password Generator
                </button>
                <button id="passphraseGeneratorTab" class="tab-button flex-1 py-3 px-6 rounded-lg font-medium bg-gray-100 hover:bg-gray-200 transition-colors">
                    üìù Passphrase Generator
                </button>
                <button id="passwordCheckerTab" class="tab-button flex-1 py-3 px-6 rounded-lg font-medium bg-gray-100 hover:bg-gray-200 transition-colors">
                    üîç Password Checker
                </button>
            </div>
        </div>

        <!-- Password Generator Section -->
        <div id="passwordGeneratorSection" class="space-y-8">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">Password Generator</h2>
                
                <div class="space-y-6">
                    <!-- Generated Password Display -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Generated Password</label>
                        <div class="password-display" id="generatedPassword">
                            Click "Generate Password" to create a secure password
                        </div>
                        <div class="flex gap-2 mt-2">
                            <button id="copyPassword" class="px-4 py-2 bg-indigo-500 text-white rounded hover:bg-indigo-600 transition-colors" disabled>
                                Copy Password
                            </button>
                            <button id="generateNewPassword" class="px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600 transition-colors">
                                Generate Password
                            </button>
                            <button id="savePassword" class="px-4 py-2 bg-purple-500 text-white rounded hover:bg-purple-600 transition-colors" disabled>
                                Save to History
                            </button>
                        </div>
                    </div>
                    
                    <!-- Password Strength Indicator -->
                    <div id="passwordStrengthSection" class="hidden">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Password Strength</label>
                        <div class="bg-gray-200 rounded-full h-2 mb-2">
                            <div id="strengthBar" class="strength-indicator"></div>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span id="strengthText" class="font-medium"></span>
                            <span id="strengthScore"></span>
                        </div>
                    </div>
                    
                    <!-- Password Options -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-4">Password Length</label>
                            <div class="flex items-center gap-4">
                                <input type="range" id="passwordLength" min="4" max="128" value="16" 
                                       class="flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                                <span id="lengthValue" class="text-lg font-semibold text-gray-700 min-w-[3rem]">16</span>
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-4">Character Sets</label>
                            <div class="space-y-3">
                                <div class="flex items-center justify-between">
                                    <span class="text-sm">Uppercase Letters (A-Z)</span>
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="includeUppercase" checked>
                                        <span class="slider"></span>
                                    </label>
                                </div>
                                <div class="flex items-center justify-between">
                                    <span class="text-sm">Lowercase Letters (a-z)</span>
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="includeLowercase" checked>
                                        <span class="slider"></span>
                                    </label>
                                </div>
                                <div class="flex items-center justify-between">
                                    <span class="text-sm">Numbers (0-9)</span>
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="includeNumbers" checked>
                                        <span class="slider"></span>
                                    </label>
                                </div>
                                <div class="flex items-center justify-between">
                                    <span class="text-sm">Symbols (!@#$%^&*)</span>
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="includeSymbols" checked>
                                        <span class="slider"></span>
                                    </label>
                                </div>
                                <div class="flex items-center justify-between">
                                    <span class="text-sm">Exclude Ambiguous (0, O, l, I)</span>
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="excludeAmbiguous" checked>
                                        <span class="slider"></span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Bulk Generation -->
                    <div class="border-t pt-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Bulk Password Generation</h3>
                        <div class="flex items-center gap-4 mb-4">
                            <label for="bulkCount" class="text-sm font-medium text-gray-700">Number of passwords:</label>
                            <select id="bulkCount" class="border border-gray-300 rounded px-3 py-2">
                                <option value="5">5</option>
                                <option value="10" selected>10</option>
                                <option value="20">20</option>
                                <option value="50">50</option>
                            </select>
                            <button id="generateBulk" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors">
                                Generate Multiple
                            </button>
                        </div>
                        <div id="bulkPasswords" class="hidden">
                            <textarea id="bulkPasswordsText" readonly 
                                      class="w-full h-32 p-3 border border-gray-300 rounded bg-gray-50 resize-vertical font-mono text-sm"></textarea>
                            <div class="flex gap-2 mt-2">
                                <button id="copyBulkPasswords" class="px-4 py-2 bg-indigo-500 text-white rounded hover:bg-indigo-600 transition-colors">
                                    Copy All
                                </button>
                                <button id="downloadBulkPasswords" class="px-4 py-2 bg-purple-500 text-white rounded hover:bg-purple-600 transition-colors">
                                    Download .txt
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Passphrase Generator Section -->
        <div id="passphraseGeneratorSection" class="space-y-8 hidden">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">Passphrase Generator</h2>
                
                <div class="space-y-6">
                    <!-- Generated Passphrase Display -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Generated Passphrase</label>
                        <div class="password-display" id="generatedPassphrase">
                            Click "Generate Passphrase" to create a memorable passphrase
                        </div>
                        <div class="flex gap-2 mt-2">
                            <button id="copyPassphrase" class="px-4 py-2 bg-indigo-500 text-white rounded hover:bg-indigo-600 transition-colors" disabled>
                                Copy Passphrase
                            </button>
                            <button id="generateNewPassphrase" class="px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600 transition-colors">
                                Generate Passphrase
                            </button>
                            <button id="savePassphrase" class="px-4 py-2 bg-purple-500 text-white rounded hover:bg-purple-600 transition-colors" disabled>
                                Save to History
                            </button>
                        </div>
                    </div>
                    
                    <!-- Passphrase Strength Indicator -->
                    <div id="passphraseStrengthSection" class="hidden">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Passphrase Strength</label>
                        <div class="bg-gray-200 rounded-full h-2 mb-2">
                            <div id="passphraseStrengthBar" class="strength-indicator"></div>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span id="passphraseStrengthText" class="font-medium"></span>
                            <span id="passphraseStrengthScore"></span>
                        </div>
                    </div>
                    
                    <!-- Passphrase Options -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-4">Number of Words</label>
                            <div class="flex items-center gap-4">
                                <input type="range" id="wordCount" min="3" max="8" value="4" 
                                       class="flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                                <span id="wordCountValue" class="text-lg font-semibold text-gray-700 min-w-[2rem]">4</span>
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-4">Options</label>
                            <div class="space-y-3">
                                <div class="flex items-center justify-between">
                                    <span class="text-sm">Capitalize Words</span>
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="capitalizeWords" checked>
                                        <span class="slider"></span>
                                    </label>
                                </div>
                                <div class="flex items-center justify-between">
                                    <span class="text-sm">Include Numbers</span>
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="includeNumbersPassphrase">
                                        <span class="slider"></span>
                                    </label>
                                </div>
                                <div class="flex items-center justify-between">
                                    <span class="text-sm">Include Symbols</span>
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="includeSymbolsPassphrase">
                                        <span class="slider"></span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Separator Options -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Word Separator</label>
                        <div class="flex flex-wrap gap-2">
                            <button class="separator-btn px-3 py-2 border border-gray-300 rounded hover:bg-gray-50 transition-colors active" data-separator="-">
                                Hyphen (-)
                            </button>
                            <button class="separator-btn px-3 py-2 border border-gray-300 rounded hover:bg-gray-50 transition-colors" data-separator=" ">
                                Space ( )
                            </button>
                            <button class="separator-btn px-3 py-2 border border-gray-300 rounded hover:bg-gray-50 transition-colors" data-separator="_">
                                Underscore (_)
                            </button>
                            <button class="separator-btn px-3 py-2 border border-gray-300 rounded hover:bg-gray-50 transition-colors" data-separator=".">
                                Dot (.)
                            </button>
                            <button class="separator-btn px-3 py-2 border border-gray-300 rounded hover:bg-gray-50 transition-colors" data-separator="">
                                None
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Password Checker Section -->
        <div id="passwordCheckerSection" class="space-y-8 hidden">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">Password Strength Checker</h2>
                
                <div class="space-y-6">
                    <!-- Password Input -->
                    <div>
                        <label for="passwordToCheck" class="block text-sm font-medium text-gray-700 mb-2">Enter Password to Check</label>
                        <div class="relative">
                            <input type="password" id="passwordToCheck" placeholder="Enter your password..." 
                                   class="w-full p-3 border border-gray-300 rounded focus:ring-2 focus:ring-indigo-500 focus:border-transparent pr-12">
                            <button id="togglePasswordVisibility" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700">
                                üëÅÔ∏è
                            </button>
                        </div>
                        <p class="text-sm text-gray-500 mt-1">Your password is never sent to any server - all checking happens in your browser</p>
                    </div>
                    
                    <!-- Strength Analysis -->
                    <div id="strengthAnalysis" class="hidden">
                        <div class="bg-gray-50 rounded-lg p-4">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">Strength Analysis</h3>
                            
                            <!-- Overall Strength -->
                            <div class="mb-4">
                                <div class="flex justify-between mb-2">
                                    <span class="text-sm font-medium text-gray-700">Overall Strength</span>
                                    <span id="checkStrengthScore" class="text-sm font-semibold"></span>
                                </div>
                                <div class="bg-gray-200 rounded-full h-3">
                                    <div id="checkStrengthBar" class="strength-indicator h-3"></div>
                                </div>
                                <p id="checkStrengthText" class="text-sm mt-1 font-medium"></p>
                            </div>
                            
                            <!-- Detailed Analysis -->
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <h4 class="text-sm font-semibold text-gray-700 mb-2">Composition</h4>
                                    <ul id="compositionAnalysis" class="text-sm space-y-1">
                                        <!-- Analysis items will be populated here -->
                                    </ul>
                                </div>
                                <div>
                                    <h4 class="text-sm font-semibold text-gray-700 mb-2">Recommendations</h4>
                                    <ul id="recommendations" class="text-sm space-y-1">
                                        <!-- Recommendations will be populated here -->
                                    </ul>
                                </div>
                            </div>
                            
                            <!-- Time to Crack Estimate -->
                            <div class="mt-4 p-3 bg-white rounded border">
                                <h4 class="text-sm font-semibold text-gray-700 mb-1">Estimated Time to Crack</h4>
                                <p id="crackTime" class="text-lg font-bold text-indigo-600"></p>
                                <p class="text-xs text-gray-500 mt-1">Based on modern hardware and common attack methods</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Password History -->
        <div class="bg-white rounded-lg shadow-lg p-6">
            <h2 class="text-xl font-semibold text-gray-800 mb-4">Password History</h2>
            <div id="passwordHistory" class="space-y-2">
                <p class="text-gray-500 text-center py-8">No passwords saved yet. Generate and save some passwords to see them here.</p>
            </div>
            <div class="mt-4 text-center">
                <button id="clearHistory" class="px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600 transition-colors">
                    Clear History
                </button>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-8 mt-20">
        <div class="container mx-auto px-4 text-center">
            <p class="mb-4">Need these tools regularly? Support the project:</p>
            <div class="flex justify-center space-x-4 mb-4">
                <a href="https://saweria.co/ahmad25kamel" target="_blank" rel="noopener noreferrer" 
                   class="bg-orange-500 hover:bg-orange-600 px-6 py-2 rounded transition-colors">
                    ‚òï Saweria (Indonesia)
                </a>
                <a href="https://github.com/sponsors/ahmad25kamel" target="_blank" rel="noopener noreferrer" 
                   class="bg-purple-500 hover:bg-purple-600 px-6 py-2 rounded transition-colors">
                    üíñ GitHub Sponsors
                </a>
            </div>
            <p class="text-sm opacity-75">All tools run locally in your browser. No data is sent to servers.</p>
        </div>
    </footer>

    <!-- Support Button -->
    <button id="supportBtn" class="floating-btn">‚òï Support</button>

    <!-- Support Modal -->
    <div id="supportModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white p-8 rounded-lg max-w-md w-full mx-4">
            <h3 class="text-xl font-bold mb-4">Support This Project</h3>
            <p class="text-gray-600 mb-6">These tools are free and run entirely in your browser. If they've been helpful, consider supporting the project:</p>
            <div class="space-y-3">
                <a href="https://saweria.co/ahmad25kamel" target="_blank" rel="noopener noreferrer" 
                   class="block w-full bg-orange-500 hover:bg-orange-600 text-white text-center py-3 rounded transition-colors">
                    ‚òï Saweria (Indonesia)
                </a>
                <a href="https://github.com/sponsors/ahmad25kamel" target="_blank" rel="noopener noreferrer" 
                   class="block w-full bg-purple-500 hover:bg-purple-600 text-white text-center py-3 rounded transition-colors">
                    üíñ GitHub Sponsors
                </a>
            </div>
            <button id="closeSupportModal" class="mt-4 w-full bg-gray-200 hover:bg-gray-300 py-2 rounded transition-colors">
                Close
            </button>
        </div>
    </div>

    <script>
        // Common words for passphrase generation
        const commonWords = [
            'apple', 'beach', 'chair', 'dream', 'eagle', 'flame', 'grape', 'house', 'ice', 'jade',
            'kite', 'lemon', 'moon', 'night', 'ocean', 'piano', 'queen', 'river', 'snow', 'tiger',
            'unity', 'voice', 'water', 'xenon', 'youth', 'zebra', 'anchor', 'bridge', 'cloud', 'dance',
            'earth', 'forest', 'garden', 'heart', 'island', 'jewel', 'knight', 'light', 'magic', 'nature',
            'orange', 'peace', 'quest', 'rainbow', 'spirit', 'trust', 'unique', 'valley', 'wisdom', 'crystal',
            'flower', 'gentle', 'happy', 'joy', 'kind', 'laugh', 'music', 'noble', 'peace', 'quiet',
            'royal', 'sweet', 'truth', 'wonder', 'bright', 'calm', 'deep', 'fresh', 'green', 'pure'
        ];

        // Character sets for password generation
        const charSets = {
            uppercase: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',
            lowercase: 'abcdefghijklmnopqrstuvwxyz',
            numbers: '0123456789',
            symbols: '!@#$%^&*()_+-=[]{}|;:,.<>?',
            ambiguous: '0O1lI'
        };

        // Password strength calculation
        function calculatePasswordStrength(password) {
            let score = 0;
            let feedback = [];
            
            // Length scoring
            if (password.length >= 8) score += 25;
            else feedback.push('Use at least 8 characters');
            
            if (password.length >= 12) score += 25;
            else if (password.length >= 8) feedback.push('Consider using 12+ characters for better security');
            
            // Character variety scoring
            if (/[a-z]/.test(password)) score += 10;
            else feedback.push('Include lowercase letters');
            
            if (/[A-Z]/.test(password)) score += 10;
            else feedback.push('Include uppercase letters');
            
            if (/[0-9]/.test(password)) score += 10;
            else feedback.push('Include numbers');
            
            if (/[^a-zA-Z0-9]/.test(password)) score += 20;
            else feedback.push('Include special characters');
            
            // Pattern penalties
            if (/(.)\1{2,}/.test(password)) {
                score -= 10;
                feedback.push('Avoid repeating characters');
            }
            
            if (/123|abc|qwe/i.test(password)) {
                score -= 15;
                feedback.push('Avoid common sequences');
            }
            
            // Common password penalty
            const commonPasswords = ['password', '123456', 'qwerty', 'admin', 'welcome'];
            if (commonPasswords.some(common => password.toLowerCase().includes(common))) {
                score -= 20;
                feedback.push('Avoid common words');
            }
            
            score = Math.max(0, Math.min(100, score));
            
            let level, className;
            if (score < 30) {
                level = 'Very Weak';
                className = 'strength-very-weak';
            } else if (score < 50) {
                level = 'Weak';
                className = 'strength-weak';
            } else if (score < 70) {
                level = 'Fair';
                className = 'strength-fair';
            } else if (score < 90) {
                level = 'Good';
                className = 'strength-good';
            } else {
                level = 'Strong';
                className = 'strength-strong';
            }
            
            return { score, level, className, feedback };
        }

        // Estimate time to crack password
        function estimateCrackTime(password) {
            const charSpace = getCharacterSpace(password);
            const entropy = Math.log2(Math.pow(charSpace, password.length));
            
            // Assume 1 billion guesses per second (modern GPU)
            const guessesPerSecond = 1e9;
            const averageGuesses = Math.pow(charSpace, password.length) / 2;
            const seconds = averageGuesses / guessesPerSecond;
            
            if (seconds < 1) return 'Instantly';
            if (seconds < 60) return `${Math.round(seconds)} seconds`;
            if (seconds < 3600) return `${Math.round(seconds / 60)} minutes`;
            if (seconds < 86400) return `${Math.round(seconds / 3600)} hours`;
            if (seconds < 31536000) return `${Math.round(seconds / 86400)} days`;
            if (seconds < 31536000 * 100) return `${Math.round(seconds / 31536000)} years`;
            return 'Centuries';
        }

        function getCharacterSpace(password) {
            let space = 0;
            if (/[a-z]/.test(password)) space += 26;
            if (/[A-Z]/.test(password)) space += 26;
            if (/[0-9]/.test(password)) space += 10;
            if (/[^a-zA-Z0-9]/.test(password)) space += 32; // Approximate
            return space || 1;
        }

        // Generate secure random password
        function generatePassword(length, options) {
            let charset = '';
            
            if (options.uppercase) charset += charSets.uppercase;
            if (options.lowercase) charset += charSets.lowercase;
            if (options.numbers) charset += charSets.numbers;
            if (options.symbols) charset += charSets.symbols;
            
            if (options.excludeAmbiguous) {
                charset = charset.split('').filter(char => !charSets.ambiguous.includes(char)).join('');
            }
            
            if (!charset) {
                throw new Error('At least one character set must be selected');
            }
            
            let password = '';
            const array = new Uint8Array(length);
            crypto.getRandomValues(array);
            
            for (let i = 0; i < length; i++) {
                password += charset[array[i] % charset.length];
            }
            
            return password;
        }

        // Generate secure passphrase
        function generatePassphrase(wordCount, options) {
            let passphrase = [];
            const array = new Uint8Array(wordCount);
            crypto.getRandomValues(array);
            
            for (let i = 0; i < wordCount; i++) {
                let word = commonWords[array[i] % commonWords.length];
                
                if (options.capitalize) {
                    word = word.charAt(0).toUpperCase() + word.slice(1);
                }
                
                if (options.includeNumbers && Math.random() > 0.7) {
                    word += Math.floor(Math.random() * 100);
                }
                
                if (options.includeSymbols && Math.random() > 0.8) {
                    const symbols = '!@#$%&*';
                    word += symbols[Math.floor(Math.random() * symbols.length)];
                }
                
                passphrase.push(word);
            }
            
            return passphrase.join(options.separator || '-');
        }

        // Show notification
        function showNotification(message, type = 'success') {
            const container = document.getElementById('notificationContainer');
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <div class="flex items-center">
                    <span class="mr-2">${type === 'success' ? '‚úÖ' : type === 'warning' ? '‚ö†Ô∏è' : '‚ùå'}</span>
                    <span>${message}</span>
                </div>
            `;
            
            container.appendChild(notification);
            setTimeout(() => notification.classList.add('show'), 100);
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => container.removeChild(notification), 300);
            }, 3000);
        }

        // Copy to clipboard
        async function copyToClipboard(text, successMessage) {
            try {
                await navigator.clipboard.writeText(text);
                showNotification(successMessage);
            } catch (err) {
                console.error('Failed to copy: ', err);
                showNotification('Failed to copy to clipboard', 'error');
            }
        }

        // Download file
        function downloadFile(content, filename, contentType) {
            const blob = new Blob([content], { type: contentType });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            showNotification(`Downloaded ${filename}`);
        }

        // Update strength display
        function updateStrengthDisplay(password, barId, textId, scoreId) {
            const strength = calculatePasswordStrength(password);
            const bar = document.getElementById(barId);
            const text = document.getElementById(textId);
            const score = document.getElementById(scoreId);
            
            bar.className = `strength-indicator ${strength.className}`;
            text.textContent = strength.level;
            score.textContent = `${strength.score}/100`;
            
            return strength;
        }

        // Local storage for password history
        function saveToHistory(password, type = 'password') {
            const history = JSON.parse(localStorage.getItem('passwordHistory') || '[]');
            const entry = {
                id: Date.now(),
                password: password,
                type: type,
                timestamp: new Date().toISOString(),
                strength: calculatePasswordStrength(password)
            };
            history.unshift(entry);
            localStorage.setItem('passwordHistory', JSON.stringify(history.slice(0, 50))); // Keep last 50
            displayPasswordHistory();
            showNotification(`${type.charAt(0).toUpperCase() + type.slice(1)} saved to history`);
        }

        function displayPasswordHistory() {
            const container = document.getElementById('passwordHistory');
            const history = JSON.parse(localStorage.getItem('passwordHistory') || '[]');
            
            if (history.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-center py-8">No passwords saved yet. Generate and save some passwords to see them here.</p>';
                return;
            }
            
            container.innerHTML = history.map(entry => `
                <div class="border border-gray-200 rounded-lg p-4">
                    <div class="flex justify-between items-start mb-2">
                        <div class="flex-1">
                            <div class="flex items-center gap-2 mb-1">
                                <span class="text-xs px-2 py-1 rounded ${entry.type === 'password' ? 'bg-blue-100 text-blue-700' : 'bg-green-100 text-green-700'}">
                                    ${entry.type}
                                </span>
                                <span class="text-xs px-2 py-1 rounded ${entry.strength.className.replace('strength-', 'bg-gray-100 text-')}">
                                    ${entry.strength.level}
                                </span>
                                <span class="text-xs text-gray-500">${new Date(entry.timestamp).toLocaleDateString()}</span>
                            </div>
                            <div class="password-history-item text-sm mb-2 break-all">${entry.password}</div>
                        </div>
                        <button onclick="deleteFromHistory(${entry.id})" class="text-red-500 hover:text-red-700 ml-2">üóëÔ∏è</button>
                    </div>
                    <div class="flex gap-2 text-xs">
                        <button onclick="copyToClipboard('${entry.password}', 'Password copied!')" 
                                class="px-2 py-1 bg-blue-100 text-blue-700 rounded hover:bg-blue-200 transition-colors">
                            Copy
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function deleteFromHistory(id) {
            const history = JSON.parse(localStorage.getItem('passwordHistory') || '[]');
            const filtered = history.filter(entry => entry.id !== id);
            localStorage.setItem('passwordHistory', JSON.stringify(filtered));
            displayPasswordHistory();
            showNotification('Entry deleted from history');
        }

        function clearHistory() {
            if (confirm('Are you sure you want to clear all password history?')) {
                localStorage.removeItem('passwordHistory');
                displayPasswordHistory();
                showNotification('Password history cleared');
            }
        }

        // Tab functionality
        const tabs = {
            'passwordGeneratorTab': 'passwordGeneratorSection',
            'passphraseGeneratorTab': 'passphraseGeneratorSection',
            'passwordCheckerTab': 'passwordCheckerSection'
        };

        Object.keys(tabs).forEach(tabId => {
            document.getElementById(tabId).addEventListener('click', function() {
                // Hide all sections
                Object.values(tabs).forEach(sectionId => {
                    document.getElementById(sectionId).classList.add('hidden');
                });
                
                // Remove active class from all tabs
                Object.keys(tabs).forEach(id => {
                    const tab = document.getElementById(id);
                    tab.classList.remove('active');
                    tab.classList.add('bg-gray-100', 'hover:bg-gray-200');
                });
                
                // Show selected section
                document.getElementById(tabs[tabId]).classList.remove('hidden');
                
                // Add active class to selected tab
                this.classList.add('active');
                this.classList.remove('bg-gray-100', 'hover:bg-gray-200');
            });
        });

        // Password generator functionality
        const passwordLengthSlider = document.getElementById('passwordLength');
        const lengthValue = document.getElementById('lengthValue');
        const generatedPasswordDiv = document.getElementById('generatedPassword');
        let currentPassword = '';

        passwordLengthSlider.addEventListener('input', function() {
            lengthValue.textContent = this.value;
        });

        document.getElementById('generateNewPassword').addEventListener('click', function() {
            try {
                const options = {
                    uppercase: document.getElementById('includeUppercase').checked,
                    lowercase: document.getElementById('includeLowercase').checked,
                    numbers: document.getElementById('includeNumbers').checked,
                    symbols: document.getElementById('includeSymbols').checked,
                    excludeAmbiguous: document.getElementById('excludeAmbiguous').checked
                };
                
                const length = parseInt(passwordLengthSlider.value);
                currentPassword = generatePassword(length, options);
                
                generatedPasswordDiv.textContent = currentPassword;
                
                // Update strength indicator
                updateStrengthDisplay(currentPassword, 'strengthBar', 'strengthText', 'strengthScore');
                document.getElementById('passwordStrengthSection').classList.remove('hidden');
                
                // Enable buttons
                document.getElementById('copyPassword').disabled = false;
                document.getElementById('savePassword').disabled = false;
                
            } catch (error) {
                showNotification(error.message, 'error');
            }
        });

        document.getElementById('copyPassword').addEventListener('click', function() {
            copyToClipboard(currentPassword, 'Password copied to clipboard!');
        });

        document.getElementById('savePassword').addEventListener('click', function() {
            saveToHistory(currentPassword, 'password');
        });

        // Bulk password generation
        document.getElementById('generateBulk').addEventListener('click', function() {
            try {
                const count = parseInt(document.getElementById('bulkCount').value);
                const options = {
                    uppercase: document.getElementById('includeUppercase').checked,
                    lowercase: document.getElementById('includeLowercase').checked,
                    numbers: document.getElementById('includeNumbers').checked,
                    symbols: document.getElementById('includeSymbols').checked,
                    excludeAmbiguous: document.getElementById('excludeAmbiguous').checked
                };
                const length = parseInt(passwordLengthSlider.value);
                
                const passwords = [];
                for (let i = 0; i < count; i++) {
                    passwords.push(generatePassword(length, options));
                }
                
                document.getElementById('bulkPasswordsText').value = passwords.join('\n');
                document.getElementById('bulkPasswords').classList.remove('hidden');
                
            } catch (error) {
                showNotification(error.message, 'error');
            }
        });

        document.getElementById('copyBulkPasswords').addEventListener('click', function() {
            const passwords = document.getElementById('bulkPasswordsText').value;
            copyToClipboard(passwords, 'All passwords copied to clipboard!');
        });

        document.getElementById('downloadBulkPasswords').addEventListener('click', function() {
            const passwords = document.getElementById('bulkPasswordsText').value;
            const timestamp = new Date().toISOString().slice(0, 19).replace(/[:-]/g, '');
            downloadFile(passwords, `passwords_${timestamp}.txt`, 'text/plain');
        });

        // Passphrase generator functionality
        const wordCountSlider = document.getElementById('wordCount');
        const wordCountValue = document.getElementById('wordCountValue');
        const generatedPassphraseDiv = document.getElementById('generatedPassphrase');
        let currentPassphrase = '';
        let selectedSeparator = '-';

        wordCountSlider.addEventListener('input', function() {
            wordCountValue.textContent = this.value;
        });

        // Separator selection
        document.querySelectorAll('.separator-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.separator-btn').forEach(b => b.classList.remove('active', 'bg-indigo-500', 'text-white'));
                this.classList.add('active', 'bg-indigo-500', 'text-white');
                selectedSeparator = this.dataset.separator;
            });
        });

        document.getElementById('generateNewPassphrase').addEventListener('click', function() {
            const options = {
                capitalize: document.getElementById('capitalizeWords').checked,
                includeNumbers: document.getElementById('includeNumbersPassphrase').checked,
                includeSymbols: document.getElementById('includeSymbolsPassphrase').checked,
                separator: selectedSeparator
            };
            
            const wordCount = parseInt(wordCountSlider.value);
            currentPassphrase = generatePassphrase(wordCount, options);
            
            generatedPassphraseDiv.textContent = currentPassphrase;
            
            // Update strength indicator
            updateStrengthDisplay(currentPassphrase, 'passphraseStrengthBar', 'passphraseStrengthText', 'passphraseStrengthScore');
            document.getElementById('passphraseStrengthSection').classList.remove('hidden');
            
            // Enable buttons
            document.getElementById('copyPassphrase').disabled = false;
            document.getElementById('savePassphrase').disabled = false;
        });

        document.getElementById('copyPassphrase').addEventListener('click', function() {
            copyToClipboard(currentPassphrase, 'Passphrase copied to clipboard!');
        });

        document.getElementById('savePassphrase').addEventListener('click', function() {
            saveToHistory(currentPassphrase, 'passphrase');
        });

        // Password checker functionality
        const passwordToCheck = document.getElementById('passwordToCheck');
        const togglePasswordVisibility = document.getElementById('togglePasswordVisibility');

        togglePasswordVisibility.addEventListener('click', function() {
            const type = passwordToCheck.getAttribute('type') === 'password' ? 'text' : 'password';
            passwordToCheck.setAttribute('type', type);
            this.textContent = type === 'password' ? 'üëÅÔ∏è' : 'üôà';
        });

        passwordToCheck.addEventListener('input', function() {
            const password = this.value;
            
            if (password.length === 0) {
                document.getElementById('strengthAnalysis').classList.add('hidden');
                return;
            }
            
            // Update strength display
            const strength = updateStrengthDisplay(password, 'checkStrengthBar', 'checkStrengthText', 'checkStrengthScore');
            
            // Update composition analysis
            const composition = document.getElementById('compositionAnalysis');
            composition.innerHTML = `
                <li class="flex items-center"><span class="mr-2">${/[a-z]/.test(password) ? '‚úÖ' : '‚ùå'}</span>Lowercase letters</li>
                <li class="flex items-center"><span class="mr-2">${/[A-Z]/.test(password) ? '‚úÖ' : '‚ùå'}</span>Uppercase letters</li>
                <li class="flex items-center"><span class="mr-2">${/[0-9]/.test(password) ? '‚úÖ' : '‚ùå'}</span>Numbers</li>
                <li class="flex items-center"><span class="mr-2">${/[^a-zA-Z0-9]/.test(password) ? '‚úÖ' : '‚ùå'}</span>Special characters</li>
                <li class="flex items-center"><span class="mr-2">${password.length >= 8 ? '‚úÖ' : '‚ùå'}</span>8+ characters (${password.length})</li>
            `;
            
            // Update recommendations
            const recommendations = document.getElementById('recommendations');
            if (strength.feedback.length > 0) {
                recommendations.innerHTML = strength.feedback.map(item => `<li class="flex items-start"><span class="mr-2 mt-0.5">üí°</span>${item}</li>`).join('');
            } else {
                recommendations.innerHTML = '<li class="flex items-center"><span class="mr-2">üéâ</span>Excellent password!</li>';
            }
            
            // Update crack time estimate
            document.getElementById('crackTime').textContent = estimateCrackTime(password);
            
            document.getElementById('strengthAnalysis').classList.remove('hidden');
        });

        // Clear history functionality
        document.getElementById('clearHistory').addEventListener('click', clearHistory);

        // Support modal functionality
        const supportBtn = document.getElementById('supportBtn');
        const supportModal = document.getElementById('supportModal');
        const closeSupportModal = document.getElementById('closeSupportModal');

        supportBtn.addEventListener('click', function() {
            supportModal.classList.remove('hidden');
        });

        closeSupportModal.addEventListener('click', function() {
            supportModal.classList.add('hidden');
        });

        // Close modal when clicking outside
        supportModal.addEventListener('click', function(e) {
            if (e.target === supportModal) {
                supportModal.classList.add('hidden');
            }
        });

        // Initialize password history display
        displayPasswordHistory();
    </script>
    
    <!-- Dark Mode Toggle -->
    <script src="../assets/js/theme-toggle.js"></script>
</body>
</html>